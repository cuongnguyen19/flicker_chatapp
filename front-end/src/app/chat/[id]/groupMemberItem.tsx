import { User } from "@/redux/slices/user";
import { AvatarWithoutStatus } from "@/shared/components/avatarWithoutStatus";
import { Dropdown, MenuProps } from "antd";
import React, { useContext, useState } from "react";
import { LogoutOutlined, LoadingOutlined, MinusCircleOutlined } from "@ant-design/icons";
import { useRouter } from "next/navigation";
import { createPrivateChat } from "@/shared/APIs/conversationAPI";
import { MessageInstance } from "antd/es/message/interface";
import { ClientContext } from "../layout";
import { Conversation, leaveConversation } from "@/redux/slices/chat";
import { connect } from "react-redux";
import { AppDispatch, RootState } from "@/redux/store";

type Props = {
  data: User & {
    role: "ROLE_PARTICIPANT" | "ROLE_ADMIN" | "ROLE_SUB_ADMIN";
  };
  self?: User & {
    role: "ROLE_PARTICIPANT" | "ROLE_ADMIN" | "ROLE_SUB_ADMIN";
  };
  isSelf: boolean;
  messageApi: MessageInstance;
  conversation: Conversation;
  dispatch: AppDispatch;
};

const groupMemberItem = ({ self, data, isSelf, messageApi, conversation, dispatch }: Props) => {
  const router = useRouter();
  const [open, setOpen] = useState(false);
  const [loading, setLoading] = useState(false);
  const client = useContext(ClientContext);

  const handleMenuClick: MenuProps["onClick"] = async (info) => {
    if (info.key === "vp") {
      router.push(`/profile/${data.id}`);
      setOpen(false);
    } else if (info.key === "m") {
      try {
        setLoading(true);
        const response = await createPrivateChat(data.id);
        router.push(`/chat/${response.id}`);
      } catch (e: any) {
        messageApi.error(e.message);
        setLoading(false);
      }
    } else if (info.key === "lg") {
      if (client && client.connected && self) {
        setLoading(true);
        client.publish({
          destination: `/app/update/${conversation.id}/user/leave/${self.id}`,
        });
        dispatch(leaveConversation({ conversationId: conversation.id, pushFunction: router.push }));
      }
    } else if (info.key === "pm-sub-admin") {
      if (client && client.connected && self) {
        client.publish({
          destination: `/app/role/grant/${conversation.id}/${self.id}`,
          body: JSON.stringify({
            userId: data.id,
            role: "ROLE_SUB_ADMIN",
          }),
        });
        setOpen(false);
      }
    } else if (info.key === "pm-admin") {
      if (client && client.connected && self) {
        client.publish({
          destination: `/app/role/grant/${conversation.id}/${self.id}`,
          body: JSON.stringify({
            userId: data.id,
            role: "ROLE_ADMIN",
          }),
        });
        setOpen(false);
      }
    } else if (info.key === "pm-participant") {
      if (client && client.connected && self) {
        client.publish({
          destination: `/app/role/grant/${conversation.id}/${self.id}`,
          body: JSON.stringify({
            userId: data.id,
            role: "ROLE_PARTICIPANT",
          }),
        });
        setOpen(false);
      }
    } else if (info.key === "rm") {
      if (client && client.connected && self) {
        client.publish({
          destination: `/app/update/${conversation.id}/users/remove/${self.id}`,
          body: JSON.stringify({
            userIds: [data.id],
          }),
        });
        setOpen(false);
      }
    }
  };

  const menuProps = {
    items: isSelf
      ? [
          {
            label: "View profile",
            key: "vp",
            icon: (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 0C8.06053 0.00368503 6.16393 0.571311 4.54128 1.63374C2.91862 2.69617 1.63994 4.20754 0.86099 5.98377C0.0820354 7.76 -0.163575 9.72442 0.154075 11.6378C0.471725 13.5511 1.33893 15.3308 2.65005 16.76C3.58647 17.775 4.72299 18.5851 5.98799 19.1392C7.25298 19.6933 8.61903 19.9793 10 19.9793C11.3811 19.9793 12.7471 19.6933 14.0121 19.1392C15.2771 18.5851 16.4136 17.775 17.35 16.76C18.6612 15.3308 19.5284 13.5511 19.846 11.6378C20.1637 9.72442 19.9181 7.76 19.1391 5.98377C18.3602 4.20754 17.0815 2.69617 15.4588 1.63374C13.8362 0.571311 11.9396 0.00368503 10 0ZM10 18C7.92851 17.9969 5.93896 17.1903 4.45005 15.75C4.90209 14.6495 5.67108 13.7083 6.6593 13.0459C7.64752 12.3835 8.81036 12.0298 10 12.0298C11.1897 12.0298 12.3526 12.3835 13.3408 13.0459C14.329 13.7083 15.098 14.6495 15.55 15.75C14.0611 17.1903 12.0716 17.9969 10 18ZM8.00005 8C8.00005 7.60444 8.11735 7.21776 8.33711 6.88886C8.55687 6.55996 8.86923 6.30362 9.23468 6.15224C9.60013 6.00087 10.0023 5.96126 10.3902 6.03843C10.7782 6.1156 11.1346 6.30608 11.4143 6.58579C11.694 6.86549 11.8844 7.22186 11.9616 7.60982C12.0388 7.99778 11.9992 8.39991 11.8478 8.76537C11.6964 9.13082 11.4401 9.44318 11.1112 9.66294C10.7823 9.8827 10.3956 10 10 10C9.46962 10 8.96091 9.78929 8.58584 9.41421C8.21076 9.03914 8.00005 8.53043 8.00005 8ZM16.91 14C16.0166 12.4718 14.6415 11.283 13 10.62C13.5092 10.0427 13.841 9.33066 13.9555 8.56944C14.0701 7.80822 13.9625 7.03011 13.6458 6.3285C13.3291 5.62688 12.8166 5.03156 12.17 4.61397C11.5233 4.19637 10.7698 3.97425 10 3.97425C9.23026 3.97425 8.47682 4.19637 7.83014 4.61397C7.18346 5.03156 6.67102 5.62688 6.3543 6.3285C6.03758 7.03011 5.93004 7.80822 6.04458 8.56944C6.15912 9.33066 6.49088 10.0427 7.00005 10.62C5.35865 11.283 3.98352 12.4718 3.09005 14C2.37799 12.7871 2.00177 11.4065 2.00005 10C2.00005 7.87827 2.8429 5.84344 4.34319 4.34315C5.84349 2.84285 7.87832 2 10 2C12.1218 2 14.1566 2.84285 15.6569 4.34315C17.1572 5.84344 18 7.87827 18 10C17.9983 11.4065 17.6221 12.7871 16.91 14Z"
                  fill="black"
                />
              </svg>
            ),
          },
          {
            type: "divider",
            key: "divider",
          },
          {
            label: "Leave group",
            key: "lg",
            icon: loading ? <LoadingOutlined /> : <LogoutOutlined />,
            danger: true,
          },
        ]
      : self?.role === "ROLE_ADMIN"
      ? [
          {
            label: "View profile",
            key: "vp",
            icon: (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 0C8.06053 0.00368503 6.16393 0.571311 4.54128 1.63374C2.91862 2.69617 1.63994 4.20754 0.86099 5.98377C0.0820354 7.76 -0.163575 9.72442 0.154075 11.6378C0.471725 13.5511 1.33893 15.3308 2.65005 16.76C3.58647 17.775 4.72299 18.5851 5.98799 19.1392C7.25298 19.6933 8.61903 19.9793 10 19.9793C11.3811 19.9793 12.7471 19.6933 14.0121 19.1392C15.2771 18.5851 16.4136 17.775 17.35 16.76C18.6612 15.3308 19.5284 13.5511 19.846 11.6378C20.1637 9.72442 19.9181 7.76 19.1391 5.98377C18.3602 4.20754 17.0815 2.69617 15.4588 1.63374C13.8362 0.571311 11.9396 0.00368503 10 0ZM10 18C7.92851 17.9969 5.93896 17.1903 4.45005 15.75C4.90209 14.6495 5.67108 13.7083 6.6593 13.0459C7.64752 12.3835 8.81036 12.0298 10 12.0298C11.1897 12.0298 12.3526 12.3835 13.3408 13.0459C14.329 13.7083 15.098 14.6495 15.55 15.75C14.0611 17.1903 12.0716 17.9969 10 18ZM8.00005 8C8.00005 7.60444 8.11735 7.21776 8.33711 6.88886C8.55687 6.55996 8.86923 6.30362 9.23468 6.15224C9.60013 6.00087 10.0023 5.96126 10.3902 6.03843C10.7782 6.1156 11.1346 6.30608 11.4143 6.58579C11.694 6.86549 11.8844 7.22186 11.9616 7.60982C12.0388 7.99778 11.9992 8.39991 11.8478 8.76537C11.6964 9.13082 11.4401 9.44318 11.1112 9.66294C10.7823 9.8827 10.3956 10 10 10C9.46962 10 8.96091 9.78929 8.58584 9.41421C8.21076 9.03914 8.00005 8.53043 8.00005 8ZM16.91 14C16.0166 12.4718 14.6415 11.283 13 10.62C13.5092 10.0427 13.841 9.33066 13.9555 8.56944C14.0701 7.80822 13.9625 7.03011 13.6458 6.3285C13.3291 5.62688 12.8166 5.03156 12.17 4.61397C11.5233 4.19637 10.7698 3.97425 10 3.97425C9.23026 3.97425 8.47682 4.19637 7.83014 4.61397C7.18346 5.03156 6.67102 5.62688 6.3543 6.3285C6.03758 7.03011 5.93004 7.80822 6.04458 8.56944C6.15912 9.33066 6.49088 10.0427 7.00005 10.62C5.35865 11.283 3.98352 12.4718 3.09005 14C2.37799 12.7871 2.00177 11.4065 2.00005 10C2.00005 7.87827 2.8429 5.84344 4.34319 4.34315C5.84349 2.84285 7.87832 2 10 2C12.1218 2 14.1566 2.84285 15.6569 4.34315C17.1572 5.84344 18 7.87827 18 10C17.9983 11.4065 17.6221 12.7871 16.91 14Z"
                  fill="black"
                />
              </svg>
            ),
          },
          {
            label: "Message",
            key: "m",
            icon: loading ? (
              <LoadingOutlined />
            ) : (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 7C9.80222 7 9.60888 7.05865 9.44443 7.16853C9.27998 7.27841 9.15181 7.43459 9.07612 7.61732C9.00043 7.80004 8.98063 8.00111 9.01921 8.19509C9.0578 8.38907 9.15304 8.56725 9.29289 8.70711C9.43275 8.84696 9.61093 8.9422 9.80491 8.98079C9.99889 9.01937 10.2 8.99957 10.3827 8.92388C10.5654 8.84819 10.7216 8.72002 10.8315 8.55557C10.9414 8.39112 11 8.19778 11 8C11 7.73478 10.8946 7.48043 10.7071 7.29289C10.5196 7.10536 10.2652 7 10 7ZM17 0H3C2.20435 0 1.44129 0.316071 0.87868 0.87868C0.316071 1.44129 0 2.20435 0 3V13C0 13.7956 0.316071 14.5587 0.87868 15.1213C1.44129 15.6839 2.20435 16 3 16H14.59L18.29 19.71C18.3834 19.8027 18.4943 19.876 18.6161 19.9258C18.7379 19.9755 18.8684 20.0008 19 20C19.1312 20.0034 19.2613 19.976 19.38 19.92C19.5626 19.845 19.7189 19.7176 19.8293 19.5539C19.9396 19.3901 19.999 19.1974 20 19V3C20 2.20435 19.6839 1.44129 19.1213 0.87868C18.5587 0.316071 17.7956 0 17 0ZM18 16.59L15.71 14.29C15.6166 14.1973 15.5057 14.124 15.3839 14.0742C15.2621 14.0245 15.1316 13.9992 15 14H3C2.73478 14 2.48043 13.8946 2.29289 13.7071C2.10536 13.5196 2 13.2652 2 13V3C2 2.73478 2.10536 2.48043 2.29289 2.29289C2.48043 2.10536 2.73478 2 3 2H17C17.2652 2 17.5196 2.10536 17.7071 2.29289C17.8946 2.48043 18 2.73478 18 3V16.59ZM6 7C5.80222 7 5.60888 7.05865 5.44443 7.16853C5.27998 7.27841 5.15181 7.43459 5.07612 7.61732C5.00043 7.80004 4.98063 8.00111 5.01921 8.19509C5.0578 8.38907 5.15304 8.56725 5.29289 8.70711C5.43275 8.84696 5.61093 8.9422 5.80491 8.98079C5.99889 9.01937 6.19996 8.99957 6.38268 8.92388C6.56541 8.84819 6.72159 8.72002 6.83147 8.55557C6.94135 8.39112 7 8.19778 7 8C7 7.73478 6.89464 7.48043 6.70711 7.29289C6.51957 7.10536 6.26522 7 6 7ZM14 7C13.8022 7 13.6089 7.05865 13.4444 7.16853C13.28 7.27841 13.1518 7.43459 13.0761 7.61732C13.0004 7.80004 12.9806 8.00111 13.0192 8.19509C13.0578 8.38907 13.153 8.56725 13.2929 8.70711C13.4327 8.84696 13.6109 8.9422 13.8049 8.98079C13.9989 9.01937 14.2 8.99957 14.3827 8.92388C14.5654 8.84819 14.7216 8.72002 14.8315 8.55557C14.9414 8.39112 15 8.19778 15 8C15 7.73478 14.8946 7.48043 14.7071 7.29289C14.5196 7.10536 14.2652 7 14 7Z"
                  fill="black"
                />
              </svg>
            ),
          },
          {
            type: "divider",
            key: "divider",
          },
          {
            label: "Promote",
            key: "pm",
            type: "group",
            children: [
              {
                key: "pm-admin",
                label: "Admin",
                icon: (
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 16 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M15.63 1.65C15.5138 1.55602 15.3781 1.48928 15.2327 1.45467C15.0873 1.42006 14.9361 1.41846 14.79 1.45C13.7214 1.67395 12.6183 1.6768 11.5486 1.45839C10.4789 1.23997 9.46525 0.804917 8.57001 0.180003C8.40261 0.063876 8.20374 0.00164795 8.00001 0.00164795C7.79627 0.00164795 7.5974 0.063876 7.43001 0.180003C6.53476 0.804917 5.52108 1.23997 4.45137 1.45839C3.38166 1.6768 2.27857 1.67395 1.21001 1.45C1.06394 1.41846 0.912671 1.42006 0.767306 1.45467C0.621942 1.48928 0.486181 1.55602 0.370006 1.65C0.253985 1.74412 0.160527 1.86304 0.0964981 1.99802C0.0324695 2.133 -0.00050219 2.28061 5.78149e-06 2.43V9.88C-0.000883255 11.3138 0.340779 12.727 0.996541 14.002C1.6523 15.277 2.60319 16.3768 3.77001 17.21L7.42001 19.81C7.58937 19.9306 7.7921 19.9954 8.00001 19.9954C8.20791 19.9954 8.41064 19.9306 8.58001 19.81L12.23 17.21C13.3968 16.3768 14.3477 15.277 15.0035 14.002C15.6592 12.727 16.0009 11.3138 16 9.88V2.43C16.0005 2.28061 15.9675 2.133 15.9035 1.99802C15.8395 1.86304 15.746 1.74412 15.63 1.65ZM14 9.88C14.0008 10.9948 13.7353 12.0936 13.2257 13.085C12.716 14.0765 11.977 14.9319 11.07 15.58L8.00001 17.77L4.93001 15.58C4.02304 14.9319 3.28399 14.0765 2.77435 13.085C2.26472 12.0936 1.99924 10.9948 2.00001 9.88V3.58C4.09643 3.75944 6.19605 3.27303 8.00001 2.19C9.80397 3.27303 11.9036 3.75944 14 3.58V9.88ZM9.54001 7.59L6.85001 10.29L5.96001 9.39C5.7717 9.2017 5.51631 9.09591 5.25001 9.09591C4.9837 9.09591 4.72831 9.2017 4.54001 9.39C4.3517 9.57831 4.24591 9.8337 4.24591 10.1C4.24591 10.3663 4.3517 10.6217 4.54001 10.81L6.14001 12.41C6.23297 12.5037 6.34357 12.5781 6.46543 12.6289C6.58729 12.6797 6.71799 12.7058 6.85001 12.7058C6.98202 12.7058 7.11272 12.6797 7.23458 12.6289C7.35644 12.5781 7.46704 12.5037 7.56001 12.41L11 9C11.1883 8.8117 11.2941 8.5563 11.2941 8.29C11.2941 8.0237 11.1883 7.76831 11 7.58C10.8117 7.3917 10.5563 7.28591 10.29 7.28591C10.0237 7.28591 9.76831 7.3917 9.58001 7.58L9.54001 7.59Z"
                      fill="black"
                    />
                  </svg>
                ),
              },
              {
                key: "pm-sub-admin",
                label: "Moderator",
                icon: (
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 16 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M15.63 1.65031C15.5138 1.55633 15.3781 1.48958 15.2327 1.45497C15.0873 1.42036 14.9361 1.41877 14.79 1.45031C13.7214 1.67425 12.6183 1.67711 11.5486 1.45869C10.4789 1.24028 9.46525 0.805223 8.57001 0.180309C8.40261 0.0641812 8.20374 0.00195312 8.00001 0.00195312C7.79627 0.00195312 7.5974 0.0641812 7.43001 0.180309C6.53476 0.805223 5.52108 1.24028 4.45137 1.45869C3.38166 1.67711 2.27857 1.67425 1.21001 1.45031C1.06394 1.41877 0.912671 1.42036 0.767306 1.45497C0.621942 1.48958 0.486181 1.55633 0.370006 1.65031C0.253985 1.74443 0.160527 1.86334 0.0964981 1.99832C0.0324695 2.1333 -0.00050219 2.28091 5.78149e-06 2.43031V9.88031C-0.000883255 11.3141 0.340779 12.7273 0.996541 14.0023C1.6523 15.2773 2.60319 16.3771 3.77001 17.2103L7.42001 19.8103C7.58937 19.9309 7.7921 19.9957 8.00001 19.9957C8.20791 19.9957 8.41064 19.9309 8.58001 19.8103L12.23 17.2103C13.3968 16.3771 14.3477 15.2773 15.0035 14.0023C15.6592 12.7273 16.0009 11.3141 16 9.88031V2.43031C16.0005 2.28091 15.9675 2.1333 15.9035 1.99832C15.8395 1.86334 15.746 1.74443 15.63 1.65031ZM14 9.88031C14.0008 10.9951 13.7353 12.0939 13.2257 13.0853C12.716 14.0768 11.977 14.9322 11.07 15.5803L8.00001 17.7703L4.93001 15.5803C4.02304 14.9322 3.28399 14.0768 2.77435 13.0853C2.26472 12.0939 1.99924 10.9951 2.00001 9.88031V3.58031C4.09643 3.75974 6.19605 3.27333 8.00001 2.19031C9.80397 3.27333 11.9036 3.75974 14 3.58031V9.88031Z"
                      fill="black"
                    />
                  </svg>
                ),
              },
              {
                key: "pm-participant",
                label: "Participant",
                icon: (
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M19.7099 18.2902L3.70994 2.29019L1.70994 0.290185C1.52164 0.101882 1.26624 -0.00390625 0.999941 -0.00390625C0.73364 -0.00390625 0.478245 0.101882 0.289941 0.290185C0.101637 0.478489 -0.00415039 0.733884 -0.00415039 1.00019C-0.00415039 1.26649 0.101637 1.52188 0.289941 1.71019L1.99994 3.41019V9.88019C2.00064 11.3122 2.34307 12.7235 2.99876 13.9966C3.65446 15.2697 4.6045 16.368 5.76994 17.2002L9.41994 19.8102C9.5893 19.9308 9.79204 19.9956 9.99994 19.9956C10.2078 19.9956 10.4106 19.9308 10.5799 19.8102L14.2299 17.2002C14.5321 16.9865 14.8194 16.7526 15.0899 16.5002L18.2899 19.7102C18.3829 19.8039 18.4935 19.8783 18.6154 19.9291C18.7372 19.9798 18.8679 20.006 18.9999 20.006C19.132 20.006 19.2627 19.9798 19.3845 19.9291C19.5064 19.8783 19.617 19.8039 19.7099 19.7102C19.8037 19.6172 19.8781 19.5066 19.9288 19.3848C19.9796 19.2629 20.0057 19.1322 20.0057 19.0002C20.0057 18.8682 19.9796 18.7375 19.9288 18.6156C19.8781 18.4937 19.8037 18.3831 19.7099 18.2902ZM13.0699 15.5802L9.99994 17.7702L6.92994 15.5802C6.02298 14.932 5.28393 14.0766 4.77429 13.0852C4.26465 12.0938 3.99917 10.9949 3.99994 9.88019V5.41019L13.6699 15.0902C13.4799 15.2602 13.2799 15.4202 13.0699 15.5802ZM8.06994 3.07019C8.74224 2.84506 9.38911 2.55012 9.99994 2.19019C11.7991 3.28494 13.9026 3.77225 15.9999 3.58019V9.88019C16.0006 10.2757 15.9671 10.6705 15.8999 11.0602C15.8785 11.1902 15.8831 11.3232 15.9132 11.4515C15.9434 11.5798 15.9987 11.7009 16.0758 11.8078C16.1529 11.9146 16.2504 12.0052 16.3627 12.0743C16.475 12.1433 16.5998 12.1895 16.7299 12.2102H16.8899C17.1296 12.2133 17.3625 12.1302 17.546 11.976C17.7296 11.8218 17.8516 11.6068 17.8899 11.3702C17.9684 10.874 18.0086 10.3725 18.0099 9.87018V2.43019C18.009 2.28248 17.9753 2.13682 17.9113 2.00369C17.8473 1.87055 17.7547 1.75324 17.6399 1.66019C17.5258 1.56592 17.3921 1.49818 17.2486 1.46187C17.105 1.42555 16.9552 1.42156 16.8099 1.45019C15.7402 1.68223 14.6339 1.68916 13.5614 1.47051C12.4888 1.25187 11.4735 0.812449 10.5799 0.180185C10.4125 0.064058 10.2137 0.00182998 10.0099 0.00182998C9.80621 0.00182998 9.60734 0.064058 9.43994 0.180185C8.82338 0.605504 8.15013 0.942125 7.43994 1.18019C7.31519 1.22221 7.19993 1.28839 7.10075 1.37496C7.00157 1.46152 6.92042 1.56678 6.86192 1.68471C6.80342 1.80264 6.76871 1.93094 6.7598 2.06228C6.75088 2.19362 6.76792 2.32543 6.80994 2.45019C6.85196 2.57494 6.91815 2.6902 7.00471 2.78938C7.09128 2.88855 7.19653 2.96971 7.31446 3.02821C7.55264 3.14636 7.82799 3.16505 8.07994 3.08019L8.06994 3.07019Z"
                      fill="black"
                    />
                  </svg>
                ),
              },
            ],
          },
          {
            label: "Remove member",
            key: "rm",
            disabled: data.role === "ROLE_ADMIN",
            danger: true,
            icon: <MinusCircleOutlined />,
          },
        ]
      : self?.role === "ROLE_SUB_ADMIN"
      ? [
          {
            label: "View profile",
            key: "vp",
            icon: (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 0C8.06053 0.00368503 6.16393 0.571311 4.54128 1.63374C2.91862 2.69617 1.63994 4.20754 0.86099 5.98377C0.0820354 7.76 -0.163575 9.72442 0.154075 11.6378C0.471725 13.5511 1.33893 15.3308 2.65005 16.76C3.58647 17.775 4.72299 18.5851 5.98799 19.1392C7.25298 19.6933 8.61903 19.9793 10 19.9793C11.3811 19.9793 12.7471 19.6933 14.0121 19.1392C15.2771 18.5851 16.4136 17.775 17.35 16.76C18.6612 15.3308 19.5284 13.5511 19.846 11.6378C20.1637 9.72442 19.9181 7.76 19.1391 5.98377C18.3602 4.20754 17.0815 2.69617 15.4588 1.63374C13.8362 0.571311 11.9396 0.00368503 10 0ZM10 18C7.92851 17.9969 5.93896 17.1903 4.45005 15.75C4.90209 14.6495 5.67108 13.7083 6.6593 13.0459C7.64752 12.3835 8.81036 12.0298 10 12.0298C11.1897 12.0298 12.3526 12.3835 13.3408 13.0459C14.329 13.7083 15.098 14.6495 15.55 15.75C14.0611 17.1903 12.0716 17.9969 10 18ZM8.00005 8C8.00005 7.60444 8.11735 7.21776 8.33711 6.88886C8.55687 6.55996 8.86923 6.30362 9.23468 6.15224C9.60013 6.00087 10.0023 5.96126 10.3902 6.03843C10.7782 6.1156 11.1346 6.30608 11.4143 6.58579C11.694 6.86549 11.8844 7.22186 11.9616 7.60982C12.0388 7.99778 11.9992 8.39991 11.8478 8.76537C11.6964 9.13082 11.4401 9.44318 11.1112 9.66294C10.7823 9.8827 10.3956 10 10 10C9.46962 10 8.96091 9.78929 8.58584 9.41421C8.21076 9.03914 8.00005 8.53043 8.00005 8ZM16.91 14C16.0166 12.4718 14.6415 11.283 13 10.62C13.5092 10.0427 13.841 9.33066 13.9555 8.56944C14.0701 7.80822 13.9625 7.03011 13.6458 6.3285C13.3291 5.62688 12.8166 5.03156 12.17 4.61397C11.5233 4.19637 10.7698 3.97425 10 3.97425C9.23026 3.97425 8.47682 4.19637 7.83014 4.61397C7.18346 5.03156 6.67102 5.62688 6.3543 6.3285C6.03758 7.03011 5.93004 7.80822 6.04458 8.56944C6.15912 9.33066 6.49088 10.0427 7.00005 10.62C5.35865 11.283 3.98352 12.4718 3.09005 14C2.37799 12.7871 2.00177 11.4065 2.00005 10C2.00005 7.87827 2.8429 5.84344 4.34319 4.34315C5.84349 2.84285 7.87832 2 10 2C12.1218 2 14.1566 2.84285 15.6569 4.34315C17.1572 5.84344 18 7.87827 18 10C17.9983 11.4065 17.6221 12.7871 16.91 14Z"
                  fill="black"
                />
              </svg>
            ),
          },
          {
            label: "Message",
            key: "m",
            icon: loading ? (
              <LoadingOutlined />
            ) : (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 7C9.80222 7 9.60888 7.05865 9.44443 7.16853C9.27998 7.27841 9.15181 7.43459 9.07612 7.61732C9.00043 7.80004 8.98063 8.00111 9.01921 8.19509C9.0578 8.38907 9.15304 8.56725 9.29289 8.70711C9.43275 8.84696 9.61093 8.9422 9.80491 8.98079C9.99889 9.01937 10.2 8.99957 10.3827 8.92388C10.5654 8.84819 10.7216 8.72002 10.8315 8.55557C10.9414 8.39112 11 8.19778 11 8C11 7.73478 10.8946 7.48043 10.7071 7.29289C10.5196 7.10536 10.2652 7 10 7ZM17 0H3C2.20435 0 1.44129 0.316071 0.87868 0.87868C0.316071 1.44129 0 2.20435 0 3V13C0 13.7956 0.316071 14.5587 0.87868 15.1213C1.44129 15.6839 2.20435 16 3 16H14.59L18.29 19.71C18.3834 19.8027 18.4943 19.876 18.6161 19.9258C18.7379 19.9755 18.8684 20.0008 19 20C19.1312 20.0034 19.2613 19.976 19.38 19.92C19.5626 19.845 19.7189 19.7176 19.8293 19.5539C19.9396 19.3901 19.999 19.1974 20 19V3C20 2.20435 19.6839 1.44129 19.1213 0.87868C18.5587 0.316071 17.7956 0 17 0ZM18 16.59L15.71 14.29C15.6166 14.1973 15.5057 14.124 15.3839 14.0742C15.2621 14.0245 15.1316 13.9992 15 14H3C2.73478 14 2.48043 13.8946 2.29289 13.7071C2.10536 13.5196 2 13.2652 2 13V3C2 2.73478 2.10536 2.48043 2.29289 2.29289C2.48043 2.10536 2.73478 2 3 2H17C17.2652 2 17.5196 2.10536 17.7071 2.29289C17.8946 2.48043 18 2.73478 18 3V16.59ZM6 7C5.80222 7 5.60888 7.05865 5.44443 7.16853C5.27998 7.27841 5.15181 7.43459 5.07612 7.61732C5.00043 7.80004 4.98063 8.00111 5.01921 8.19509C5.0578 8.38907 5.15304 8.56725 5.29289 8.70711C5.43275 8.84696 5.61093 8.9422 5.80491 8.98079C5.99889 9.01937 6.19996 8.99957 6.38268 8.92388C6.56541 8.84819 6.72159 8.72002 6.83147 8.55557C6.94135 8.39112 7 8.19778 7 8C7 7.73478 6.89464 7.48043 6.70711 7.29289C6.51957 7.10536 6.26522 7 6 7ZM14 7C13.8022 7 13.6089 7.05865 13.4444 7.16853C13.28 7.27841 13.1518 7.43459 13.0761 7.61732C13.0004 7.80004 12.9806 8.00111 13.0192 8.19509C13.0578 8.38907 13.153 8.56725 13.2929 8.70711C13.4327 8.84696 13.6109 8.9422 13.8049 8.98079C13.9989 9.01937 14.2 8.99957 14.3827 8.92388C14.5654 8.84819 14.7216 8.72002 14.8315 8.55557C14.9414 8.39112 15 8.19778 15 8C15 7.73478 14.8946 7.48043 14.7071 7.29289C14.5196 7.10536 14.2652 7 14 7Z"
                  fill="black"
                />
              </svg>
            ),
          },
          {
            type: "divider",
            key: "divider",
          },
          {
            label: "Remove member",
            key: "rm",
            disabled: data.role === "ROLE_ADMIN",
            danger: true,
            icon: <MinusCircleOutlined />,
          },
        ]
      : [
          {
            label: "View profile",
            key: "vp",
            icon: (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 0C8.06053 0.00368503 6.16393 0.571311 4.54128 1.63374C2.91862 2.69617 1.63994 4.20754 0.86099 5.98377C0.0820354 7.76 -0.163575 9.72442 0.154075 11.6378C0.471725 13.5511 1.33893 15.3308 2.65005 16.76C3.58647 17.775 4.72299 18.5851 5.98799 19.1392C7.25298 19.6933 8.61903 19.9793 10 19.9793C11.3811 19.9793 12.7471 19.6933 14.0121 19.1392C15.2771 18.5851 16.4136 17.775 17.35 16.76C18.6612 15.3308 19.5284 13.5511 19.846 11.6378C20.1637 9.72442 19.9181 7.76 19.1391 5.98377C18.3602 4.20754 17.0815 2.69617 15.4588 1.63374C13.8362 0.571311 11.9396 0.00368503 10 0ZM10 18C7.92851 17.9969 5.93896 17.1903 4.45005 15.75C4.90209 14.6495 5.67108 13.7083 6.6593 13.0459C7.64752 12.3835 8.81036 12.0298 10 12.0298C11.1897 12.0298 12.3526 12.3835 13.3408 13.0459C14.329 13.7083 15.098 14.6495 15.55 15.75C14.0611 17.1903 12.0716 17.9969 10 18ZM8.00005 8C8.00005 7.60444 8.11735 7.21776 8.33711 6.88886C8.55687 6.55996 8.86923 6.30362 9.23468 6.15224C9.60013 6.00087 10.0023 5.96126 10.3902 6.03843C10.7782 6.1156 11.1346 6.30608 11.4143 6.58579C11.694 6.86549 11.8844 7.22186 11.9616 7.60982C12.0388 7.99778 11.9992 8.39991 11.8478 8.76537C11.6964 9.13082 11.4401 9.44318 11.1112 9.66294C10.7823 9.8827 10.3956 10 10 10C9.46962 10 8.96091 9.78929 8.58584 9.41421C8.21076 9.03914 8.00005 8.53043 8.00005 8ZM16.91 14C16.0166 12.4718 14.6415 11.283 13 10.62C13.5092 10.0427 13.841 9.33066 13.9555 8.56944C14.0701 7.80822 13.9625 7.03011 13.6458 6.3285C13.3291 5.62688 12.8166 5.03156 12.17 4.61397C11.5233 4.19637 10.7698 3.97425 10 3.97425C9.23026 3.97425 8.47682 4.19637 7.83014 4.61397C7.18346 5.03156 6.67102 5.62688 6.3543 6.3285C6.03758 7.03011 5.93004 7.80822 6.04458 8.56944C6.15912 9.33066 6.49088 10.0427 7.00005 10.62C5.35865 11.283 3.98352 12.4718 3.09005 14C2.37799 12.7871 2.00177 11.4065 2.00005 10C2.00005 7.87827 2.8429 5.84344 4.34319 4.34315C5.84349 2.84285 7.87832 2 10 2C12.1218 2 14.1566 2.84285 15.6569 4.34315C17.1572 5.84344 18 7.87827 18 10C17.9983 11.4065 17.6221 12.7871 16.91 14Z"
                  fill="black"
                />
              </svg>
            ),
          },
          {
            label: "Message",
            key: "m",
            icon: loading ? (
              <LoadingOutlined />
            ) : (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 7C9.80222 7 9.60888 7.05865 9.44443 7.16853C9.27998 7.27841 9.15181 7.43459 9.07612 7.61732C9.00043 7.80004 8.98063 8.00111 9.01921 8.19509C9.0578 8.38907 9.15304 8.56725 9.29289 8.70711C9.43275 8.84696 9.61093 8.9422 9.80491 8.98079C9.99889 9.01937 10.2 8.99957 10.3827 8.92388C10.5654 8.84819 10.7216 8.72002 10.8315 8.55557C10.9414 8.39112 11 8.19778 11 8C11 7.73478 10.8946 7.48043 10.7071 7.29289C10.5196 7.10536 10.2652 7 10 7ZM17 0H3C2.20435 0 1.44129 0.316071 0.87868 0.87868C0.316071 1.44129 0 2.20435 0 3V13C0 13.7956 0.316071 14.5587 0.87868 15.1213C1.44129 15.6839 2.20435 16 3 16H14.59L18.29 19.71C18.3834 19.8027 18.4943 19.876 18.6161 19.9258C18.7379 19.9755 18.8684 20.0008 19 20C19.1312 20.0034 19.2613 19.976 19.38 19.92C19.5626 19.845 19.7189 19.7176 19.8293 19.5539C19.9396 19.3901 19.999 19.1974 20 19V3C20 2.20435 19.6839 1.44129 19.1213 0.87868C18.5587 0.316071 17.7956 0 17 0ZM18 16.59L15.71 14.29C15.6166 14.1973 15.5057 14.124 15.3839 14.0742C15.2621 14.0245 15.1316 13.9992 15 14H3C2.73478 14 2.48043 13.8946 2.29289 13.7071C2.10536 13.5196 2 13.2652 2 13V3C2 2.73478 2.10536 2.48043 2.29289 2.29289C2.48043 2.10536 2.73478 2 3 2H17C17.2652 2 17.5196 2.10536 17.7071 2.29289C17.8946 2.48043 18 2.73478 18 3V16.59ZM6 7C5.80222 7 5.60888 7.05865 5.44443 7.16853C5.27998 7.27841 5.15181 7.43459 5.07612 7.61732C5.00043 7.80004 4.98063 8.00111 5.01921 8.19509C5.0578 8.38907 5.15304 8.56725 5.29289 8.70711C5.43275 8.84696 5.61093 8.9422 5.80491 8.98079C5.99889 9.01937 6.19996 8.99957 6.38268 8.92388C6.56541 8.84819 6.72159 8.72002 6.83147 8.55557C6.94135 8.39112 7 8.19778 7 8C7 7.73478 6.89464 7.48043 6.70711 7.29289C6.51957 7.10536 6.26522 7 6 7ZM14 7C13.8022 7 13.6089 7.05865 13.4444 7.16853C13.28 7.27841 13.1518 7.43459 13.0761 7.61732C13.0004 7.80004 12.9806 8.00111 13.0192 8.19509C13.0578 8.38907 13.153 8.56725 13.2929 8.70711C13.4327 8.84696 13.6109 8.9422 13.8049 8.98079C13.9989 9.01937 14.2 8.99957 14.3827 8.92388C14.5654 8.84819 14.7216 8.72002 14.8315 8.55557C14.9414 8.39112 15 8.19778 15 8C15 7.73478 14.8946 7.48043 14.7071 7.29289C14.5196 7.10536 14.2652 7 14 7Z"
                  fill="black"
                />
              </svg>
            ),
          },
        ],
    onClick: handleMenuClick,
  };

  return (
    <div className="p-2 flex justify-between items-center">
      <div className="flex gap-2 items-center">
        <AvatarWithoutStatus
          image={data.avatar}
          userName={data.displayName}
          className="w-12 h-12 rounded-full"
        />
        <div className="flex flex-col">
          <div className="flex gap-2">
            {data.displayName}{" "}
            {isSelf && <span className="bg-transparent px-1 rounded-md font-semibold">You</span>}
          </div>
          <p className="text-text">
            {data.role === "ROLE_ADMIN"
              ? "Admin"
              : data.role === "ROLE_SUB_ADMIN"
              ? "Moderator"
              : data.role === "ROLE_PARTICIPANT"
              ? "Participant"
              : "Unknown"}
          </p>
        </div>
      </div>
      <Dropdown
        trigger={["click"]}
        menu={menuProps}
        arrow
        open={open}
        onOpenChange={(flag) => setOpen(flag)}
      >
        <button className="w-10 h-10 justify-center rounded-full flex items-center gap-2 duration-500 hover:bg-gray-50 active:scale-90">
          <svg
            width="18"
            height="4"
            viewBox="0 0 18 4"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M9 0C8.60444 0 8.21776 0.117298 7.88886 0.337061C7.55996 0.556824 7.30362 0.869181 7.15224 1.23463C7.00087 1.60009 6.96126 2.00222 7.03843 2.39018C7.1156 2.77814 7.30608 3.13451 7.58579 3.41421C7.86549 3.69392 8.22186 3.8844 8.60982 3.96157C8.99778 4.03874 9.39992 3.99913 9.76537 3.84776C10.1308 3.69638 10.4432 3.44004 10.6629 3.11114C10.8827 2.78224 11 2.39556 11 2C11 1.46957 10.7893 0.96086 10.4142 0.585787C10.0391 0.210714 9.53043 0 9 0ZM2 0C1.60444 0 1.21776 0.117298 0.88886 0.337061C0.559962 0.556824 0.303617 0.869181 0.152242 1.23463C0.000866562 1.60009 -0.0387401 2.00222 0.0384303 2.39018C0.115601 2.77814 0.306082 3.13451 0.585787 3.41421C0.865492 3.69392 1.22186 3.8844 1.60982 3.96157C1.99778 4.03874 2.39992 3.99913 2.76537 3.84776C3.13082 3.69638 3.44318 3.44004 3.66294 3.11114C3.8827 2.78224 4 2.39556 4 2C4 1.46957 3.78929 0.96086 3.41421 0.585787C3.03914 0.210714 2.53043 0 2 0ZM16 0C15.6044 0 15.2178 0.117298 14.8889 0.337061C14.56 0.556824 14.3036 0.869181 14.1522 1.23463C14.0009 1.60009 13.9613 2.00222 14.0384 2.39018C14.1156 2.77814 14.3061 3.13451 14.5858 3.41421C14.8655 3.69392 15.2219 3.8844 15.6098 3.96157C15.9978 4.03874 16.3999 3.99913 16.7654 3.84776C17.1308 3.69638 17.4432 3.44004 17.6629 3.11114C17.8827 2.78224 18 2.39556 18 2C18 1.46957 17.7893 0.96086 17.4142 0.585787C17.0391 0.210714 16.5304 0 16 0Z"
              fill="black"
            />
          </svg>
        </button>
      </Dropdown>
    </div>
  );
};

export default connect()(groupMemberItem);
